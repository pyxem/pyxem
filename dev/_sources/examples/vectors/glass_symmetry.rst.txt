
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/vectors/glass_symmetry.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_examples_vectors_glass_symmetry.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_vectors_glass_symmetry.py:


===========================
Glass Symmetry from Vectors
===========================

This example shows how to identify symmetry (in a glassy system but this could be useful other places)
by looking at the angles between 3 vectors in the diffraction pattern at some radial ring in k to identify
groups of 3 vectors that are subtended by the same angle.

This is a very simple example with more detailed examples to come.

.. GENERATED FROM PYTHON SOURCE LINES 12-18

.. code-block:: Python


    import pyxem as pxm
    from scipy.ndimage import gaussian_filter
    import matplotlib.pyplot as plt
    import numpy as np








.. GENERATED FROM PYTHON SOURCE LINES 19-20

First we load the data and do some basic processing

.. GENERATED FROM PYTHON SOURCE LINES 20-29

.. code-block:: Python

    s = pxm.data.pdnip_glass(allow_download=True)
    s.axes_manager.signal_axes[0].offset = -23.7
    s.axes_manager.signal_axes[1].offset = -19.3

    s.filter(gaussian_filter, sigma=(1, 1, 0, 0), inplace=True)  # only in real space
    s.template_match_disk(disk_r=5, subtract_min=False, inplace=True)

    vectors = s.get_diffraction_vectors(threshold_abs=0.5, min_distance=3)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/17 [00:00<?, ?it/s]      6%|▌         | 1/17 [00:05<01:29,  5.60s/it]     18%|█▊        | 3/17 [00:05<00:21,  1.51s/it]     29%|██▉       | 5/17 [00:11<00:25,  2.12s/it]     41%|████      | 7/17 [00:11<00:12,  1.28s/it]     53%|█████▎    | 9/17 [00:16<00:14,  1.78s/it]     59%|█████▉    | 10/17 [00:16<00:10,  1.46s/it]     71%|███████   | 12/17 [00:17<00:04,  1.07it/s]     76%|███████▋  | 13/17 [00:21<00:07,  1.79s/it]     82%|████████▏ | 14/17 [00:22<00:04,  1.41s/it]    100%|██████████| 17/17 [00:22<00:00,  1.31s/it]
      0%|          | 0/33 [00:00<?, ?it/s]      3%|▎         | 1/33 [00:03<02:03,  3.85s/it]     21%|██        | 7/33 [00:03<00:10,  2.38it/s]     30%|███       | 10/33 [00:07<00:17,  1.33it/s]     52%|█████▏    | 17/33 [00:11<00:10,  1.56it/s]     64%|██████▎   | 21/33 [00:11<00:05,  2.24it/s]     76%|███████▌  | 25/33 [00:15<00:04,  1.65it/s]    100%|██████████| 33/33 [00:15<00:00,  2.10it/s]
      0%|          | 0/51 [00:00<?, ?it/s]    100%|██████████| 51/51 [00:00<00:00, 597.96it/s]




.. GENERATED FROM PYTHON SOURCE LINES 30-31

Now we can convert to polar vectors

.. GENERATED FROM PYTHON SOURCE LINES 31-34

.. code-block:: Python


    pol = vectors.to_polar()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/51 [00:00<?, ?it/s]     33%|███▎      | 17/51 [00:00<00:00, 128.08it/s]     61%|██████    | 31/51 [00:00<00:00, 125.18it/s]     86%|████████▋ | 44/51 [00:00<00:00, 111.82it/s]    100%|██████████| 51/51 [00:00<00:00, 128.05it/s]




.. GENERATED FROM PYTHON SOURCE LINES 35-37

This function gets the inscribed angle
accept_threshold is the maximum difference between the two angles subtended by the 3 vectors

.. GENERATED FROM PYTHON SOURCE LINES 37-60

.. code-block:: Python


    ins = pol.get_angles(min_angle=0.05, min_k=0.3, accept_threshold=0.1)

    flat_vect = ins.flatten_diffraction_vectors()

    fig, axs = plt.subplots()
    axs.hist(flat_vect.ivec["delta phi"].data, bins=60, range=(0, 2 * np.pi / 3))
    axs.set_xlabel("delta phi")
    axs.set_xticks(
        [0, np.pi / 5, np.pi / 4, 2 * np.pi / 5, np.pi / 2, np.pi / 3, 3 * np.pi / 5]
    )
    axs.set_xticklabels(
        [
            0,
            r"$\frac{\pi}{5}$",
            r"$\frac{\pi}{4}$",
            r"$\frac{2\pi}{5}$",
            r"$\frac{\pi}{2}$",
            r"$\frac{\pi}{3}$",
            r"$\frac{3\pi}{5}$",
        ]
    )




.. image-sg:: /examples/vectors/images/sphx_glr_glass_symmetry_001.png
   :alt: glass symmetry
   :srcset: /examples/vectors/images/sphx_glr_glass_symmetry_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/51 [00:00<?, ?it/s]      2%|▏         | 1/51 [00:00<00:34,  1.47it/s]      6%|▌         | 3/51 [00:01<00:16,  2.95it/s]     10%|▉         | 5/51 [00:01<00:12,  3.80it/s]     18%|█▊        | 9/51 [00:02<00:08,  4.89it/s]     22%|██▏       | 11/51 [00:02<00:09,  4.37it/s]     25%|██▌       | 13/51 [00:04<00:16,  2.31it/s]     29%|██▉       | 15/51 [00:04<00:12,  2.85it/s]     37%|███▋      | 19/51 [00:05<00:07,  4.20it/s]     41%|████      | 21/51 [00:05<00:07,  3.91it/s]     45%|████▌     | 23/51 [00:07<00:10,  2.74it/s]     49%|████▉     | 25/51 [00:07<00:09,  2.80it/s]     57%|█████▋    | 29/51 [00:08<00:04,  4.61it/s]     61%|██████    | 31/51 [00:08<00:05,  3.87it/s]     65%|██████▍   | 33/51 [00:09<00:05,  3.15it/s]     69%|██████▊   | 35/51 [00:10<00:04,  3.63it/s]     73%|███████▎  | 37/51 [00:10<00:04,  3.19it/s]     76%|███████▋  | 39/51 [00:11<00:03,  3.58it/s]     80%|████████  | 41/51 [00:11<00:02,  4.27it/s]     84%|████████▍ | 43/51 [00:13<00:03,  2.42it/s]     88%|████████▊ | 45/51 [00:13<00:02,  2.62it/s]    100%|██████████| 51/51 [00:14<00:00,  3.63it/s]
      0%|          | 0/2 [00:00<?, ?it/s]    100%|██████████| 2/2 [00:00<00:00, 3293.52it/s]

    [Text(0.0, 0, '0'), Text(0.6283185307179586, 0, '$\\frac{\\pi}{5}$'), Text(0.7853981633974483, 0, '$\\frac{\\pi}{4}$'), Text(1.2566370614359172, 0, '$\\frac{2\\pi}{5}$'), Text(1.5707963267948966, 0, '$\\frac{\\pi}{2}$'), Text(1.0471975511965976, 0, '$\\frac{\\pi}{3}$'), Text(1.8849555921538759, 0, '$\\frac{3\\pi}{5}$')]



.. GENERATED FROM PYTHON SOURCE LINES 61-62

cycle through colors in groups of 3 for each symmetry cluster

.. GENERATED FROM PYTHON SOURCE LINES 62-73

.. code-block:: Python


    points = ins.to_markers(
        color=["b", "b", "b", "g", "g", "g", "y", "y", "y", "r", "r", "r"]
    )
    original_points = vectors.to_markers(color="w", alpha=0.5)
    s.axes_manager.indices = (67, 55)  # jumping to a part with some symmetric structure

    s.plot(vmin=0.0)
    s.add_marker(points)
    s.add_marker(original_points)




.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /examples/vectors/images/sphx_glr_glass_symmetry_002.png
         :alt: PdNiP Navigator
         :srcset: /examples/vectors/images/sphx_glr_glass_symmetry_002.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /examples/vectors/images/sphx_glr_glass_symmetry_003.png
         :alt: PdNiP Signal
         :srcset: /examples/vectors/images/sphx_glr_glass_symmetry_003.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/51 [00:00<?, ?it/s]     43%|████▎     | 22/51 [00:00<00:00, 176.69it/s]     88%|████████▊ | 45/51 [00:00<00:00, 202.57it/s]    100%|██████████| 51/51 [00:00<00:00, 211.00it/s]
      0%|          | 0/51 [00:00<?, ?it/s]    100%|██████████| 51/51 [00:00<00:00, 1110.01it/s]
      0%|          | 0/51 [00:00<?, ?it/s]    100%|██████████| 51/51 [00:00<00:00, 1094.28it/s]





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (1 minutes 27.253 seconds)


.. _sphx_glr_download_examples_vectors_glass_symmetry.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: glass_symmetry.ipynb <glass_symmetry.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: glass_symmetry.py <glass_symmetry.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: glass_symmetry.zip <glass_symmetry.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
